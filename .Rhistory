labs(title = "Mean Profits by Year with 95% CI", x = "Year", y = "Mean Profits (X 1000)")
#WRITE YOUR CODE HERE
model = lm(profits ~ budget, data = movies2)
summary(model)
#look at summary of model above
#look at summary of model above
#We already created the new variable log profits before so here we start first with creating the new variable log budget and make a new regression model
movies2 = movies2%>%
mutate(budget = ifelse(budget == 0, NA_real_, budget))
movies2 = movies2 %>%
mutate(log_budget = log(budget))
movies2 = movies2 %>%
mutate(log_budget = ifelse(is.infinite(log_budget), NA_real_, log_budget))
model_new = lm(log_profits ~ log_budget, data = movies2)
summary(model_new)
#Look at summary model_new above
#Look at summary model and summary model_new above
#Concluding by looking at the summary of model and model_new above
View(movies2)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
movies2 = read_tsv("movies2.tsv")
#Here I am computing the number of observations, variables and subjects
ncol(movies2)
nrow(movies2)
#Here I am looking at the head of the dataset to determine whether the variables are nominal, ordinal, interval or ratio
head(movies2)
#Here I am making a new variable called profits
library(tidyr)
library(tidyverse)
movies2 = movies2 %>%
mutate(profits = revenue -budget)
#Here I am computing the minimum, maximum and mean values of the variable profits
summary(movies2$profits)
#Here I am making a seperate dataset with 1 variable and 1 observation to see which movie has the highest profits and how much it is.
max_profit_movie = movies2[which.max(movies2$profits), "title"]
print(max_profit_movie)
max_profit = max(movies2$profits)
#Here I am doing the same thing as above but then for the lowest profits
min_profit_movie = movies2[which.min(movies2$profits), "title"]
print(min_profit_movie)
min_profit = min(movies2$profits)
#Here I am dividing the profits into quartiles as I have to plot a boxplot
movies2$quartile = cut(movies2$profits, breaks = quantile(movies2$profits, probs = c(0, 0.25,0.5, 0.75, 1)), labels = c("Q1", "Q2", "Q3", "Q4"), include.lowest = T)
#Here I am plotting a boxplot for the profits with quartiles
library(ggplot2)
ggplot(movies2, aes(x = quartile, y = profits)) +
geom_boxplot() +
labs(title = "Boxplot of Movie Profits by Quartile", x = "Quartile", y = "Profits")
#Here I make a new variable with the log transformed profits
movies2 = movies2 %>%
mutate(log_profits = log(profits))
#Here I compute the mean but we were not sure to remove the NAs or not so in the first one we did not remove it and in the second we did to see if we would get different answers
mean(movies2$log_profits)
mean(movies2$log_profits, na.rm = T)
#Here I put NA instead of the profits that are negative or equal to 0, then I used the same code as before to calculate the logs and then I calculated the mean of the logs of the profits again.
movies2$profits = ifelse(movies2$profits <= 0 , NA, movies2$profits)
movies2 = movies2 %>%
mutate(log_profits = log(profits))
mean(movies2$log_profits, na.rm = T)
#As I have to make a boxplot, I first divided the logs into quartiles
movies2$quartiles = cut(movies2$log_profits, breaks = quantile(movies2$log_profits, probs = c(0, 0.25,0.5, 0.75, 1), na.rm = T), labels = c("Q1", "Q2", "Q3", "Q4"), include.lowest = T)
# Here I am plotting the boxplot with the log transformed profits with quartiles
ggplot(movies2, aes(x = quartiles, y = log_profits)) +
geom_boxplot() +
labs(title = "Boxplot of Movies Log Transformed Profits", x = "Quartiles", y = "Log of Profits")
#Here I plot a scatterplot with runtime on x-axis and on the y-axis the vote average
ggplot(movies2, aes(x = runtime, y = vote_average)) +
geom_point() +
labs(title = "Scatterplot Movies Average Voting and Runtime", x = "runtime", y = "average voting")
#looking for the actor with the most movies
library(dplyr)
actor = movies2 %>%
count(first_actor, sort = T) %>%
head(1)
print(actor)
#computing the average revenue of Bruce
average_rev_Bruce = movies2 %>%
filter(first_actor == "Bruce Willis") %>%
summarise(av_rev_Bruce = mean(revenue))
print(average_rev_Bruce)
#computing the average revenue general
average_rev_generally = movies2 %>%
summarise(rev_gen = mean(revenue))
print(average_rev_generally)
#computing the varience of the subset Bruce of the revenue and the general variance of the full dataset
library(tidyverse)
var_bruce = movies2 %>%
filter(first_actor == "Bruce Willis") %>%
summarise(var_bruce = var(revenue))
print(var_bruce)
var_gen = movies2 %>%
summarise(var_gen = var(revenue))
print(var_gen)
#recoding profits into millions and calculating the variance of the mean
movies2$profits = movies2$profits/1000000
library(tidyverse)
var_profits2 = var(movies2$profits, na.rm = T)
print(var_profits2)
#creation of a sample of 25 movies, new data set and computing the variance of this sample
set.seed(123)
movies_sample = movies2[sample(nrow(movies2), 25),]
var_sample_profits = var(movies_sample$profits, na.rm =T)
print(var_sample_profits)
#creating a for loop to make different samples with vectors computing the variance
set.seed(123)
sample_vars = numeric(100)
for (i in 1:100) {
samples_movies = movies2[sample(nrow(movies2), 25),]
sample_vars[i] = var(samples_movies$profits, na.rm = T)
}
head(sample_vars)
#computing the mean, standard deviation and plotting the histogram of the sample variances
summary(sample_vars)
mean(sample_vars)
sd(sample_vars)
sample_vars = data.frame(sample_vars)
library(ggplot2)
ggplot(sample_vars, aes(x = sample_vars)) +
geom_histogram(binwidth = diff(range(sample_vars))/40, colour = "black", fill = "skyblue") +
labs(title = "Distribution of Sample Variances", x = "Sample Variances", y = "Count")
#WRITE YOUR CODE HERE
thriller = movies2 %>%
filter(genre == "Thriller")
N<-length(thriller$runtime)
mean_runtime <- mean(thriller$runtime)
sd_runtime   <- sd(thriller$runtime)
t_a2 <- qt(0.995, df = N - 1)
LOW <- mean_runtime - t_a2 * (sd_runtime/ sqrt(N))
UP  <- mean_runtime + t_a2 * (sd_runtime/ sqrt(N))
CI<-paste0("(",round(LOW,4),",",round(UP,4),")")
print(CI)
#WRITE YOUR CODE HERE
N<-length(thriller$runtime)
mean_runtime <- mean(thriller$runtime)
sd_runtime   <- sd(thriller$runtime)
z_a2 <- qnorm(0.995)
LOW <- mean_runtime - z_a2 * (sd_runtime/ sqrt(N))
UP  <- mean_runtime + z_a2 * (sd_runtime/ sqrt(N))
CI<-paste0("(",round(LOW,4),",",round(UP,4),")")
print(CI)
#WRITE YOUR CODE HERE
s2 <- var(movies2$runtime)
sigma_sq <- 500
chi2_stat <- (N - 1) * s2 / sigma_sq
alpha <- 0.05
chi2_L <- qchisq(alpha/2, df = N-1)
chi2_U <- qchisq(1 - alpha/2, df = N-1)
#WRITE YOUR CODE HERE
ggplot(movies2, aes(x = revenue)) +
geom_histogram(bins = 30, fill = "skyblue", color = "black") +
labs(title = "Histogram of Revenue", x = "Revenue", y = "Count") +
theme_minimal()
#WRITE YOUR CODE HERE
movies2 <- movies2 %>%
mutate(vote_average_rounded = floor(vote_average))
# Histogram met ggplot2
ggplot(movies2, aes(x = vote_average_rounded)) +
geom_histogram(binwidth = 1, fill = "lightblue", color = "black") +
labs(title = "Histogram vote average",
x = "rounded voting average",
y = "frequency") +
scale_x_continuous(breaks = seq(1, 10, 1))
#calculting mean profits per category and plotting scatterplot
mean_profits_plot = movies2 %>%
group_by(vote_average_rounded) %>%
summarise(mean_profit = mean(profits, na.rm = T))
ggplot(mean_profits_plot, aes(x = vote_average_rounded, y = mean_profit)) +
geom_point()+
labs(title = "Vote Rate vs Mean Profits", x = "Average Vote Rate Rounded", y = "Mean Profits")
#new sub data set with yearly mean profits and 95% confidence interval.
yearly_profits = movies2 %>%
group_by(release_year) %>%
summarise(mean_profit = mean(profits, na.rm = T),
n = sum(!is.na(profits)),
se = sd(profits, na.rm = T)/ sqrt(n),
lower_ci = mean_profit - qt(0.975, df = n - 1) * se,
upper_ci = mean_profit + qt(0.975, df = n-1) * se)
ggplot(yearly_profits, aes(x  = release_year, y = mean_profit)) +
geom_point()+
geom_errorbar(aes(ymin = lower_ci, ymax = upper_ci), width = 0.2) +
labs(title = "Mean Profits by Year with 95% CI", x = "Year", y = "Mean Profits (X 1000)")
#WRITE YOUR CODE HERE
model = lm(profits ~ budget, data = movies2)
summary(model)
#look at summary of model above
#look at summary of model above
#We already created the new variable log profits before so here we start first with creating the new variable log budget and make a new regression model
movies2 = movies2%>%
mutate(budget = ifelse(budget == 0, NA_real_, budget))
movies2 = movies2 %>%
mutate(log_budget = log(budget))
movies2 = movies2 %>%
mutate(log_budget = ifelse(is.infinite(log_budget), NA_real_, log_budget))
model_new = lm(log_profits ~ log_budget, data = movies2)
summary(model_new)
#Look at summary model_new above
#Look at summary model and summary model_new above
#Concluding by looking at the summary of model and model_new above
#WRITE YOUR CODE HERE
plot_log = movies2%>%
filter(!is.na(first_actor_gender))%>%
group_by(first_actor_gender) %>%
summarise(mean_log_budget = mean(log_budget, na.rm = T),
se = sd(log_budget, na.rm = T)/sqrt(n()),
low_ci = mean_log_budget - 1.96 * se,
up_ci = mean_log_budget + 1.96 * se)
ggplot(plot_log, aes(x = first_actor_gender, y = mean_log_budget)) +
geom_point()+
geom_errorbar(aes(ymin = low_ci, ymax = up_ci), width = 0.2)+
labs(title = "Mean Log of Budgets by First Actor Gender", y = "Mean Log of Budget", x = "First Actor Gender")
#WRITE YOUR CODE HERE
ols_model = lm(log_budget ~ first_actor_gender, data = movies2)
summary(ols_model)
#WRITE YOUR CODE HERE
View(movies2)
#WRITE YOUR CODE HERE
monthly_profits = movies2 %>%
group_by(release_month) %>%
summarise(mean_profits = mean(profits, na.rm = T))
View(monthly_profits)
#WRITE YOUR CODE HERE
monthly_profits = movies2 %>%
group_by(release_month) %>%
summarise(mean_profits = mean(profits, na.rm = T),
se_profit = sd(profits, na.rm = T)/sqrt(n(), na.rm = T))
#WRITE YOUR CODE HERE
monthly_profits = movies2 %>%
group_by(release_month) %>%
summarise(mean_profits = mean(profits, na.rm = T),
se_profit = sd(profits, na.rm = T) / sqrt(n(), na.rm = T))
rlang::last_trace()
#WRITE YOUR CODE HERE
monthly_profits = movies2 %>%
group_by(release_month) %>%
summarise(mean_profits = mean(profits, na.rm = T),
se_profit = sd(profits, na.rm = T) / sqrt n(), na.rm = T)
se_profit = sd(profits, na.rm = T) / sqrt(n(), na.rm = T)
#WRITE YOUR CODE HERE
monthly_profits = movies2 %>%
#WRITE YOUR CODE HERE
monthly_profits = movies2 %>%
#WRITE YOUR CODE HERE
monthly_profits = movies2 %>%
group_by(release_month) %>%
summarise(mean_profits = mean(profits, na.rm = T),
se_profit = sd(profits, na.rm = T) / sqrt(n(), na.rm = T))
#WRITE YOUR CODE HERE
monthly_profits = movies2 %>%
group_by(release_month) %>%
summarise(mean_profits = mean(profits, na.rm = T),
se_profit = sd(profits, na.rm = T) / sqrt(n()))
ggplot(monthly_profits, aes(x = release_month, y = mean_profits)) +
geom_col()+
geom_errorbar(aes(ymin = mean_profits - se_profit, ymax = mean_profits + se_profit), width = 0.2) +
scale_x_continuous(breaks = 1:12, labels = c("Jan", "Feb", "Mar", "Apr", "May", "June", "July", "Aug", "Sep", "Oct", "Nov", "Dec")) +
labs(title = "Mean Profit by Release Month", y = "Mean Profit", x = "Release Month")
#creating dummy variable english
movies2$English_release = ifelse(movies2$original_language == "en", 1, 0)
#OLS model
model_week_5 = lm(log_profits ~ log_budget + English_release + release_month, data = movies2)
summary(model_week_5)
#Converting release month as a factor
movies2$release_month = as.factor(movies2$release_month)
flexible_model = lm(log_profits ~ log_budget + English_release + release_month, data = movies2
)
summary(flexible_model)
anova(lm(log_profits ~ log_budget + English_release, data = movies2), flexible_model)
#Testing null hypothesis, f-test for multiple terms
lm(log_profits ~ log_budget + English_release, data = movies2)
anova(lm(log_profits ~ log_budget + English_release, data = movies2), flexible_model)
prediction = data.frame(Budget = 40e6, English_release = 1, release_month = 6)
View(prediction)
new_data = data.frame(Budget = 40e6, English_release = 1, release_month = 6)
predicted_log_profit = predict(model_week_5, newdata = new_data)
new_data = data.frame(log_budget = log(40e6), English_release = 1, release_month = 6)
View(new_data)
predicted_log_profit = predict(model_week_5, newdata = new_data)
predicted_profit = exp(predicted_log_profit)
print(predicted_profit)
#prediction interval
pred_interval = predict(model_week_5, newdata = new_data, interval = "prediction", level = 0.99)
lower_bound = exp(pred_interval[1, "lwr"])
upper_bound = exp(pred_interval[1, "upr"])
cat("Predicted Profit:", predicted_profit, "\n")
cat("99% Prediction Interval:(", lower_bound, "," upper_bound,"\n")
cat("99% Prediction Interval:(", lower_bound, "," upper_bound,"\n")
cat("99% Prediction Interval:(", lower_bound, ",", upper_bound,"\n")
cat("99% Prediction Interval:(", lower_bound, ",", upper_bound,") \n")
cat("Predicted Profit:", predicted_profit, "\n")
cat("99% Prediction Interval:(", lower_bound, ",", upper_bound,") \n")
knitr::opts_chunk$set(echo = TRUE)
library(readr)
movies2 = read_tsv("movies2.tsv")
#Here I am computing the number of observations, variables and subjects
ncol(movies2)
nrow(movies2)
#Here I am looking at the head of the dataset to determine whether the variables are nominal, ordinal, interval or ratio
head(movies2)
#Here I am making a new variable called profits
library(tidyr)
library(tidyverse)
movies2 = movies2 %>%
mutate(profits = revenue -budget)
#Here I am computing the minimum, maximum and mean values of the variable profits
summary(movies2$profits)
#Here I am making a seperate dataset with 1 variable and 1 observation to see which movie has the highest profits and how much it is.
max_profit_movie = movies2[which.max(movies2$profits), "title"]
print(max_profit_movie)
max_profit = max(movies2$profits)
#Here I am doing the same thing as above but then for the lowest profits
min_profit_movie = movies2[which.min(movies2$profits), "title"]
print(min_profit_movie)
min_profit = min(movies2$profits)
#Here I am dividing the profits into quartiles as I have to plot a boxplot
movies2$quartile = cut(movies2$profits, breaks = quantile(movies2$profits, probs = c(0, 0.25,0.5, 0.75, 1)), labels = c("Q1", "Q2", "Q3", "Q4"), include.lowest = T)
#Here I am plotting a boxplot for the profits with quartiles
library(ggplot2)
ggplot(movies2, aes(x = quartile, y = profits)) +
geom_boxplot() +
labs(title = "Boxplot of Movie Profits by Quartile", x = "Quartile", y = "Profits")
#Here I make a new variable with the log transformed profits
movies2 = movies2 %>%
mutate(log_profits = log(profits))
#Here I compute the mean but we were not sure to remove the NAs or not so in the first one we did not remove it and in the second we did to see if we would get different answers
mean(movies2$log_profits)
mean(movies2$log_profits, na.rm = T)
#Here I put NA instead of the profits that are negative or equal to 0, then I used the same code as before to calculate the logs and then I calculated the mean of the logs of the profits again.
movies2$profits = ifelse(movies2$profits <= 0 , NA, movies2$profits)
movies2 = movies2 %>%
mutate(log_profits = log(profits))
mean(movies2$log_profits, na.rm = T)
#As I have to make a boxplot, I first divided the logs into quartiles
movies2$quartiles = cut(movies2$log_profits, breaks = quantile(movies2$log_profits, probs = c(0, 0.25,0.5, 0.75, 1), na.rm = T), labels = c("Q1", "Q2", "Q3", "Q4"), include.lowest = T)
# Here I am plotting the boxplot with the log transformed profits with quartiles
ggplot(movies2, aes(x = quartiles, y = log_profits)) +
geom_boxplot() +
labs(title = "Boxplot of Movies Log Transformed Profits", x = "Quartiles", y = "Log of Profits")
#Here I plot a scatterplot with runtime on x-axis and on the y-axis the vote average
ggplot(movies2, aes(x = runtime, y = vote_average)) +
geom_point() +
labs(title = "Scatterplot Movies Average Voting and Runtime", x = "runtime", y = "average voting")
#looking for the actor with the most movies
library(dplyr)
actor = movies2 %>%
count(first_actor, sort = T) %>%
head(1)
print(actor)
#computing the average revenue of Bruce
average_rev_Bruce = movies2 %>%
filter(first_actor == "Bruce Willis") %>%
summarise(av_rev_Bruce = mean(revenue))
print(average_rev_Bruce)
#computing the average revenue general
average_rev_generally = movies2 %>%
summarise(rev_gen = mean(revenue))
print(average_rev_generally)
#computing the varience of the subset Bruce of the revenue and the general variance of the full dataset
library(tidyverse)
var_bruce = movies2 %>%
filter(first_actor == "Bruce Willis") %>%
summarise(var_bruce = var(revenue))
print(var_bruce)
var_gen = movies2 %>%
summarise(var_gen = var(revenue))
print(var_gen)
#recoding profits into millions and calculating the variance of the mean
movies2$profits = movies2$profits/1000000
library(tidyverse)
var_profits2 = var(movies2$profits, na.rm = T)
print(var_profits2)
#creation of a sample of 25 movies, new data set and computing the variance of this sample
set.seed(123)
movies_sample = movies2[sample(nrow(movies2), 25),]
var_sample_profits = var(movies_sample$profits, na.rm =T)
print(var_sample_profits)
#creating a for loop to make different samples with vectors computing the variance
set.seed(123)
sample_vars = numeric(100)
for (i in 1:100) {
samples_movies = movies2[sample(nrow(movies2), 25),]
sample_vars[i] = var(samples_movies$profits, na.rm = T)
}
head(sample_vars)
#computing the mean, standard deviation and plotting the histogram of the sample variances
summary(sample_vars)
mean(sample_vars)
sd(sample_vars)
sample_vars = data.frame(sample_vars)
library(ggplot2)
ggplot(sample_vars, aes(x = sample_vars)) +
geom_histogram(binwidth = diff(range(sample_vars))/40, colour = "black", fill = "skyblue") +
labs(title = "Distribution of Sample Variances", x = "Sample Variances", y = "Count")
#WRITE YOUR CODE HERE
thriller = movies2 %>%
filter(genre == "Thriller")
N<-length(thriller$runtime)
mean_runtime <- mean(thriller$runtime)
sd_runtime   <- sd(thriller$runtime)
t_a2 <- qt(0.995, df = N - 1)
LOW <- mean_runtime - t_a2 * (sd_runtime/ sqrt(N))
UP  <- mean_runtime + t_a2 * (sd_runtime/ sqrt(N))
CI<-paste0("(",round(LOW,4),",",round(UP,4),")")
print(CI)
#WRITE YOUR CODE HERE
N<-length(thriller$runtime)
mean_runtime <- mean(thriller$runtime)
sd_runtime   <- sd(thriller$runtime)
z_a2 <- qnorm(0.995)
LOW <- mean_runtime - z_a2 * (sd_runtime/ sqrt(N))
UP  <- mean_runtime + z_a2 * (sd_runtime/ sqrt(N))
CI<-paste0("(",round(LOW,4),",",round(UP,4),")")
print(CI)
#WRITE YOUR CODE HERE
s2 <- var(movies2$runtime)
sigma_sq <- 500
chi2_stat <- (N - 1) * s2 / sigma_sq
alpha <- 0.05
chi2_L <- qchisq(alpha/2, df = N-1)
chi2_U <- qchisq(1 - alpha/2, df = N-1)
#WRITE YOUR CODE HERE
ggplot(movies2, aes(x = revenue)) +
geom_histogram(bins = 30, fill = "skyblue", color = "black") +
labs(title = "Histogram of Revenue", x = "Revenue", y = "Count") +
theme_minimal()
#WRITE YOUR CODE HERE
movies2 <- movies2 %>%
mutate(vote_average_rounded = floor(vote_average))
# Histogram met ggplot2
ggplot(movies2, aes(x = vote_average_rounded)) +
geom_histogram(binwidth = 1, fill = "lightblue", color = "black") +
labs(title = "Histogram vote average",
x = "rounded voting average",
y = "frequency") +
scale_x_continuous(breaks = seq(1, 10, 1))
#calculting mean profits per category and plotting scatterplot
mean_profits_plot = movies2 %>%
group_by(vote_average_rounded) %>%
summarise(mean_profit = mean(profits, na.rm = T))
ggplot(mean_profits_plot, aes(x = vote_average_rounded, y = mean_profit)) +
geom_point()+
labs(title = "Vote Rate vs Mean Profits", x = "Average Vote Rate Rounded", y = "Mean Profits")
#new sub data set with yearly mean profits and 95% confidence interval.
yearly_profits = movies2 %>%
group_by(release_year) %>%
summarise(mean_profit = mean(profits, na.rm = T),
n = sum(!is.na(profits)),
se = sd(profits, na.rm = T)/ sqrt(n),
lower_ci = mean_profit - qt(0.975, df = n - 1) * se,
upper_ci = mean_profit + qt(0.975, df = n-1) * se)
ggplot(yearly_profits, aes(x  = release_year, y = mean_profit)) +
geom_point()+
geom_errorbar(aes(ymin = lower_ci, ymax = upper_ci), width = 0.2) +
labs(title = "Mean Profits by Year with 95% CI", x = "Year", y = "Mean Profits (X 1000)")
#WRITE YOUR CODE HERE
model = lm(profits ~ budget, data = movies2)
summary(model)
#look at summary of model above
#look at summary of model above
#We already created the new variable log profits before so here we start first with creating the new variable log budget and make a new regression model
movies2 = movies2%>%
mutate(budget = ifelse(budget == 0, NA_real_, budget))
movies2 = movies2 %>%
mutate(log_budget = log(budget))
movies2 = movies2 %>%
mutate(log_budget = ifelse(is.infinite(log_budget), NA_real_, log_budget))
model_new = lm(log_profits ~ log_budget, data = movies2)
summary(model_new)
#Look at summary model_new above
#Look at summary model and summary model_new above
#Concluding by looking at the summary of model and model_new above
#WRITE YOUR CODE HERE
plot_log = movies2%>%
filter(!is.na(first_actor_gender))%>%
group_by(first_actor_gender) %>%
summarise(mean_log_budget = mean(log_budget, na.rm = T),
se = sd(log_budget, na.rm = T)/sqrt(n()),
low_ci = mean_log_budget - 1.96 * se,
up_ci = mean_log_budget + 1.96 * se)
ggplot(plot_log, aes(x = first_actor_gender, y = mean_log_budget)) +
geom_point()+
geom_errorbar(aes(ymin = low_ci, ymax = up_ci), width = 0.2)+
labs(title = "Mean Log of Budgets by First Actor Gender", y = "Mean Log of Budget", x = "First Actor Gender")
#WRITE YOUR CODE HERE
ols_model = lm(log_budget ~ first_actor_gender, data = movies2)
summary(ols_model)
#WRITE YOUR CODE HERE
#WRITE YOUR CODE HERE
monthly_profits = movies2 %>%
group_by(release_month) %>%
summarise(mean_profits = mean(profits, na.rm = T),
se_profit = sd(profits, na.rm = T) / sqrt(n()))
ggplot(monthly_profits, aes(x = release_month, y = mean_profits)) +
geom_col()+
geom_errorbar(aes(ymin = mean_profits - se_profit, ymax = mean_profits + se_profit), width = 0.2) +
scale_x_continuous(breaks = 1:12, labels = c("Jan", "Feb", "Mar", "Apr", "May", "June", "July", "Aug", "Sep", "Oct", "Nov", "Dec")) +
labs(title = "Mean Profit by Release Month", y = "Mean Profit", x = "Release Month")
#creating dummy variable english
movies2$English_release = ifelse(movies2$original_language == "en", 1, 0)
#OLS model
model_week_5 = lm(log_profits ~ log_budget + English_release + release_month, data = movies2)
summary(model_week_5)
#WRITE YOUR CODE HERE
#Converting release month as a factor
movies2$release_month = as.factor(movies2$release_month)
#new OLS model more flexible
flexible_model = lm(log_profits ~ log_budget + English_release + release_month, data = movies2)
summary(flexible_model)
#Testing null hypothesis, f-test for multiple terms
lm(log_profits ~ log_budget + English_release, data = movies2)
anova(lm(log_profits ~ log_budget + English_release, data = movies2), flexible_model)
#WRITE YOUR CODE HERE
